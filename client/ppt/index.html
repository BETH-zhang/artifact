<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <!-- width=26.667, height=15 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
    <title>Demo-Animals-20180423</title>
    <meta name="description" content="Demo-Animals-20180423">
    

    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">


    <style>
    #main.protected #logo {
        top:5%;
    }
    #main.protected #banner {
        top:calc(5% + 70px);
    }
    #main.protected #loading-bar{
        display:none;
    }
    #main.protected #protect-hint {
        display:block;
    }
   
    #protect-hint {
        position:absolute;
        width:100%;
        bottom:0;
        text-align: center;
        font-size:16px;
        display:none;
    }
    #protect-hint .protect-content {
        width: 15em;
        height:100%;
        display:inline-block;
        background:rgb(255,210,0);
        border-radius: 4px;
        box-sizing: border-box;
        box-shadow: 0px 0px 2px 0px white,  0px -1px 0px 1px rgba(255,255,255,0.4) inset;
        padding-bottom:1em;
        position:relative;
        border-bottom-right-radius:0;
        border-bottom-left-radius:0;
    }
    .protect-content h3 {
        /*
        background: #c167e6;
        color: white; 
        */
        margin: 0;
        padding: 1.5em 0 0.5em 0;
        margin-bottom: 1em;
        box-shadow: 0px 0px 0px 0px white,  0px 1px 0px 0px rgba(255,255,255,0.2) inset;
        position:relative;
    }
    .protect-content h3:after {
        content: "";
        width: 1em;
        height: 1em;
        background: black;
        display: block;
        border-radius: 1em;
        position: absolute;
        left: calc(50% - 0.5em);
        top: -0.7em;  
        box-shadow: -6em 0px 0px 0px black, -4.5em 0px 0px 0px black, -3em 0px 0px 0px black, -1.5em 0px 0px 0px black,6em 0px 0px 0px black, 4.5em 0px 0px 0px black, 3em 0px 0px 0px black, 1.5em 0px 0px 0px black;
    }
    .protect-content img {
        width:80%;
        height:80%;
    }
    .protect-content input:focus{
    }
    .protect-content ::-webkit-input-placeholder { letter-spacing: 0; }
    .protect-content :-moz-placeholder { letter-spacing: 0; }
    .protect-content ::-moz-placeholder { letter-spacing: 0; }
    .protect-content :-ms-input-placeholder { letter-spacing: 0; } 
    .protect-content input {
        letter-spacing:0.5em;
        font-size: 1em;
        width:8em;
        height:1em;
        padding:0.5em 0;
        border:none;
        text-align:center;
        border-radius:0;
    }
    .hint-container {
        position:relative;
        padding-top:2em;
        display:none;
    }
    .hint-container:after, .hint-container:before {
        content: "";
        font-size:1.2em;
        width: 0.5em;
        height:1px;
        position:absolute;
        top: 1em;
        left:-0.8em;
        box-shadow: 1.2em 0, 2.2em 0, 3.2em 0, 4.2em 0, 5.2em 0, 6.2em 0, 7.2em 0, 8.2em 0, 9.2em 0, 10.2em 0, 11.2em 0, 12.2em 0;
        
    }
    .hint-container:after {
        height:2px;
        color: #daa539;
    }
    .hint-container:before {
        margin-top:2px;
        color:white;
    }
    .password-container #submit-password{
        width: 3em;
        padding:0;
    }
    #hint-content {
        font-size: 0.8em;
        line-height: 1.5;
        white-space:pre-wrap;
    }
    .load-btn {
        display: inline-block;
        padding:0.2em 1.2em;
        background: #e25050;
        box-sizing: border-box;
        line-height: 2em;
        color: white;
        cursor:pointer;
    }
    #protect-hint.need-pay .password-area{
        display: none;
    }

    #protect-hint.need-pay .purchase-area{
        display: block;
    }
    #protect-hint .purchase-area{
        display:none
    }
    #protect-hint .purchase-area #qrpay-area{
        display:none;
    }
    #protect-hint .purchase-area.qrpay #qrpay-area{
        display:block;
    }
    #protect-hint .purchase-area.qrpay #base-area {
        display:none;
    }

    .pdf-page {
        width: 100%;
        height: 100%;
    }
    punctuation:before, punctuation:after {
        content: " ";
        font-size:0;
        line-height:0;
    }
    punctuation.end pole {
        display:inline-block;
        font-size: 0 !important;
    }
    #user-panel #edit-info{
        border-radius: 12px;
        display: inline-block;
        padding: 6px 12px;
        color:rgba(130,130,130,0.6);
        text-align: center;
        position: absolute;
        bottom: 20px;
        right:20px;
        z-index: 10;
    
    }
     #user-panel #edit-info:after {
        content : attr(data-current) " / " attr(data-total);
    }
    #user-panel #edit-info {
        padding:0;
    }
    .bgm-btn {
        position: absolute;
        right: 20px;
        top: 20px;
        z-index: 200;
        width: 30px;
        height: 30px;
        background-image: url(./common/images/bgm-btn.svg);
        background-size: contain;
        background-repeat: no-repeat; 
    }
    .bgm-btn.rotate {
        -webkit-animation: rotating 1.2s linear infinite;
        animation: rotating 1.2s linear infinite;
    }
    @-webkit-keyframes rotating {
        0% {
            transform: rotate(0deg)
        }

        to {
            transform: rotate(1turn)
        }
    }

    @keyframes rotating {
        0% {
            transform: rotate(0deg)
        }

        to {
            transform: rotate(1turn)
        }
    }
    #user-panel > * {
        transform:translate3d(0,0,0);
        -webkit-transform:translate3d(0,0,0);
    }
    #user-panel.fullscreen {
        -webkit-transform-origin: center center;
        transform-origin: center center;
        pointer-events:none;
        position:absolute;
        width:100%;
        height: 100%;
        top:0;
        left:0;
        z-index: 1000;
    }
    #user-panel.fullscreen> * {
        pointer-events: auto;
    }
    body.hide-bgm-btn .bgm-btn {
        display:none !important;
    }
    body.hide-page-number  #edit-info {
        display:none !important;
    } 

    </style>

    


    

    <script>
    var REM = 12;
    
    var PID = 850926
    
    </script>
    <style>
    html {
        height:100%;
        width:100%;
        font-size:12px;
        overflow:hidden;
    }
    body {
        background: #eee;
        font-family: Helvetica Neue, Helvetica, Arial, sans-serif;
        font-size: 14px;
        color:#000;
        margin: 0  auto;
        padding: 0;
        width:100%;
        height:100%;
        user-select: none;
        -webkit-user-select: none;
        position:relative;
        overflow:hidden;
    }
    #main.sized {
        width: 26.667rem;
        height: 15rem;
        position:relative;
    }
    #main.protected {
        height:auto;
        width: auto;
        position:static;
    }
    .slides-container {
        width: 26.667rem;
        height: 15rem;
    }
    .reveal-slide {
        font-size: 18px;
        background: #fff;
    }

    #loading {
        width: 100%;
        height: 100%;
        background: #000;
        position: absolute;
        z-index: 100;
        left: 0;
        top: 0;

        text-align:center;
        transition: opacity 1s;
        -webkit-transition: opacity 1s;

    }
    .hide {
        display:none;
    }
    #loading.fade {
        opacity: 0;
    }
    #loading-bar {
        position: relative;
        height: 2px;
        background: #FFFFFF;
        width: 20%;
        margin: 0 auto;
        top: 45%;
        border-radius: 1px;
        overflow: hidden;
    }
    #loading-entry {
        color:white;
        position: relative;
        margin: 0 auto;
        top: 45%;
        overflow: hidden;
        width:100%;
        text-align:center;
    }
    #loading-progress{
        width: 100%;
        height: 100%;
        background: #B8CC41;
        transform-origin: top left;
        transform: scaleX(0);
        -webkit-transform: scaleX(0);
        -webkit-transform-origin: top left;
        transition: transform 0.5s;
        -webkit-transition: -webkit-transform 0.5s;
    }
    #loading.default-logo #banner,   #loading.default-logo svg#logo{
        display:block !important;
    }
    #logo{
        position:relative;
        display: block;
        margin: 0 auto;
        top:40%;
    }
    #banner {
        position:absolute;
        bottom:10%;
        color:white;
        width:100%;
        text-align:center;
        font-size:14px;
    }   
    .rotated {
        -webkit-transform:rotate(90deg);
        transform:rotate(90deg);
    }
    img#logo{
        width: auto;
        max-width: 200px;
        max-height: 100px;
    }
    .video .image-container:after {
        content: '';
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        position: absolute;
        background: url('data:image/svg+xml;base64,PHN2ZyB0PSIxNDkzNjI3MjkyMDkwIiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjQ5NzYiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PGRlZnM+PHN0eWxlIHR5cGU9InRleHQvY3NzIj48L3N0eWxlPjwvZGVmcz48cGF0aCBkPSJNNTEyIDEwMjRDMjI5LjIzNTIgMTAyNCAwIDc5NC43NjQ4IDAgNTEyIDAgMjI5LjIzNTIgMjI5LjIzNTIgMCA1MTIgMCA3OTQuNzY0OCAwIDEwMjQgMjI5LjIzNTIgMTAyNCA1MTIgMTAyNCA3OTQuNzY0OCA3OTQuNzY0OCAxMDI0IDUxMiAxMDI0Wk01MTIgMzguNEMyNTAuODU0NCAzOC40IDM4LjQgMjUwLjg1NDQgMzguNCA1MTIgMzguNCA3NzMuMTQ1NiAyNTAuODU0NCA5ODUuNiA1MTIgOTg1LjYgNzczLjE0NTYgOTg1LjYgOTg1LjYgNzczLjE0NTYgOTg1LjYgNTEyIDk4NS42IDI1MC44NTQ0IDc3My4xNDU2IDM4LjQgNTEyIDM4LjRaTTczOC40NTc2IDU0My40NzUyQzczOC40NTc2IDU0My40NzUyIDQyNy43NjMyIDc0OS4xMiA0MjcuNzYzMiA3NDkuMTIgNDAzLjM3OTIgNzY1LjI2MDggMzcxLjIgNzQ3LjM1MzYgMzcxLjIgNzE3LjY0NDggMzcxLjIgNzE3LjY0NDggMzcxLjIgMzA2LjM1NTIgMzcxLjIgMzA2LjM1NTIgMzcxLjIgMjc2LjY0NjQgNDAzLjM3OTIgMjU4LjczOTIgNDI3Ljc2MzIgMjc0Ljg4IDQyNy43NjMyIDI3NC44OCA3MzguNDU3NiA0ODAuNTI0OCA3MzguNDU3NiA0ODAuNTI0OCA3NjAuNzgwOCA0OTUuMjk2IDc2MC43ODA4IDUyOC43MDQgNzM4LjQ1NzYgNTQzLjQ3NTJaIiBwLWlkPSI0OTc3IiBmaWxsPSIjZmZmZmZmIiBjbGFzcz0ic2VsZWN0ZWQiPjwvcGF0aD48L3N2Zz4=') no-repeat rgba(0,0,0,0.3) center center;
        opacity: 0.7;
        background-size: 16%;
    } 
    video {
        width:100%;
        height:100%;
        position:absolute;
        object-fit: fill;
        background:url('data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCIgd2lkdGg9IjY5LjgyM3B4IiBoZWlnaHQ9IjQxLjc5NHB4IiB2aWV3Qm94PSIwIDAgNjkuODIzIDQxLjc5NCI+PHRleHQgdHJhbnNmb3JtPSJtYXRyaXgoMSAwIDAgMSAxNC42NDcgMjcuNzA2MSkiIGZvbnQtc2l6ZT0iMTIiIGZpbGw9J3doaXRlJz7liqDovb3kuK0uLi48L3RleHQ+PC9zdmc+') no-repeat rgb(0,0,0) center center;
    }

    
    </style>
<!-- htmlbuild:scorm -->
<!-- endbuild -->
<script src="data/signature.js"></script>

    
    <script>
        window.doc_info =  window.doc_info || { 
            title : "Demo-Animals-20180423",
            description : "Demo-Animals-20180423",
            cover: "",
            logo : "0",
            
        }

        var isMobile = /iPhone|Android/i.test(navigator.userAgent)
        if (isMobile && doc_info.allow_embed === false && (window.top !== window.self)){
            try {
                console.error("hijack detect!")
                console.error("hijack detect!", window.top.location.href)
            }catch(e){
            }
            window.top.location.href = window.self.location.href
        }
        if (window.doc_info["redirect_url"]){
            location.href = window.doc_info["redirect_url"]
        }
        document.title = doc_info.title || document.title || ""
        document.head && (document.head.querySelector('meta[name=description]').content = doc_info.description || "");
        var pi = Math.pi = Math.PI
    </script>
    <script>
        var stageWidth = 26.667 * 12;
        var stageHeight = 15 * 12;
        var autoPlay = doc_info.auto_play;

        var stretch = doc_info.stretch || "restrict"//"restrict"; //["restrict", "fullscreen"]
        if (stretch == 'auto') {
            stretch = 'restrict';
        }
        //var stretch = "restrict"; //["restrict", "fullscreen"]
        var contentArea = {"x1":0.459,"y1":0.311,"x2":25.817,"y2":14.944,"width":25.358,"height":14.633000000000001}
        var shareDomains = []; 
        var shareLink = location.href.replace(location.host, shareDomains[Math.floor(shareDomains.length * Math.random())] || location.host).replace(/#.*$/, '').replace(/password=[^&]*/, '');
        var wxRequired = false;

        if (doc_info.auth_type){
            stretch = "restrict";
        }
        if (doc_info.forbid_share){
            if (location.href.indexOf("from=") > 0 || location.href.indexOf("#share") > 0 ){
                shareLink = "./401.html?" + (new Date().getTime());
            } else {
                shareLink = shareLink + "#share"
            }
        }
        window.FEATURES = { lazyPlay: true }
        var CDN = "."
        var commonCDN = "."
        var BACKEND = "//ppj.io"
        var UID = "fFEtjA1j" || (function(){
            var parts = window.location.href.replace(/\?.*$/, '').split("/");
            parts.pop();
            return parts.pop();
        }());
        var backend = BACKEND + "/lectures/" + UID + "/action_record"
    </script>
    <script>
    var backend = "./data"
    </script>
    
<script>
var backend = "./data"
</script>

       <script>

            window.needRotate = false;
            // var screenWidth = document.documentElement.clientWidth; var screenHeight = document.documentElement.clientHeight;
            var screenWidth = document.documentElement.clientWidth;
            var screenHeight = document.documentElement.clientHeight;
            var scaleR = 1;
            window.isDesktop = false;
            var offsetRatio = 1.0;
            var html = document.documentElement;
            var html_font_size = parseFloat(window.getComputedStyle(html, null).getPropertyValue('font-size'));
            html.style.fontSize = '20px' 
            offsetRatio = 20 / parseFloat(window.getComputedStyle(html, null).getPropertyValue('font-size'));
            //var main = document.getElementById("main");
            function calculate(setREM) {
                var screenR = screenHeight / screenWidth;
                var stageR = stageHeight / stageWidth;
                var REM = 12;
                var FONTRatio = REM / 320;
                var main_transforms = [];

                window.needRotate = (screenR - 1) * (stageR - 1) < 0;
                var dreamWidth = screenWidth;

                if (stretch == "auto"){
                    // 如果是竖版，长度超出屏幕
                    if (!window.needRotate && stageR >= screenR && screenR >1){
                        stretch = "fullscreen"
                    } else {
                        stretch = "restrict"
                    }
                    
                    if (contentArea){
                        var w = stageWidth / 12;
                        var h = stageHeight / 12;

                        var r = screenR > 1 ? 1 / screenR : screenR;
                        if (stageR < r){
                            r = 1 / r;
                            var R = 1 / stageR;
                            var gap = (r - stageR) / 2 * h;
                            if (gap > contentArea.x1 || gap > (w - contentArea.x2)){
                                stretch = "restrict";
                            }
                        } else {
                            //r = 1 / r;
                            var R = stageR;
                            var gap = (R - r) / 2 * w;
                            if (gap > contentArea.y1 || gap > (h - contentArea.y2)){
                                stretch = "restrict";
                            }
                        }
                    }
                }

                if (!window.needRotate) {
                    //先设置rem达到放大的效果,再居中
                    if (stretch != 'restrict') {
                        dreamWidth = Math.max(screenWidth, screenHeight / stageR);
                        //横轴居中
                        main_transforms.push("translateX(-" + (dreamWidth - screenWidth) / 2 + "px)");
                        scaleR = screenWidth / dreamWidth;
                    } else {
                        dreamWidth = Math.min(screenWidth, screenHeight / stageR);
                        //屏幕居中
                        main_transforms.push("translate(" + (screenWidth - dreamWidth) / 2 + "px, " + (screenHeight - dreamWidth * stageR) / 2 + "px)");
                    }

                } else {
                    if (stretch != 'restrict') {
                        dreamWidth = Math.max(screenHeight, screenWidth / stageR);
                    } else {
                        dreamWidth = Math.min(screenHeight, screenWidth / stageR);
                    }
                    //rotate: 横屏竖图 or 横图竖屏
                    if (screenR > stageR) {
                        //居中 main_transforms.push("translate(" + dreamWidth / 2 * (stageR - 1) + "px, " + (screenHeight / 2 - dreamWidth * stageR / 2) + "px)");
                        if (stretch == 'restrict'){
                            main_transforms.push("translate(" + (screenWidth - dreamWidth) / 2 + "px, " + (screenHeight - dreamWidth * stageR) / 2 + "px)");
                        }else {
                            main_transforms.push("translate(" + (screenWidth - dreamWidth) / 2 + "px, " + dreamWidth / 2 * (1 - stageR) + "px)");
                            scaleR = Math.min(screenHeight, screenWidth / stageR) / dreamWidth
                        }
                        //旋转
                        main_transforms.push("rotate(90deg)");
                    } else {
                        if (stretch == 'restrict'){
                            main_transforms.push("translate(" + (screenWidth - dreamWidth) / 2 + "px," + (screenHeight - dreamWidth * stageR) / 2 + "px)");
                        } else {
                            //居中
                            main_transforms.push("translate(" + dreamWidth / 2 * (stageR - 1) + "px," + (screenHeight / 2 - dreamWidth * stageR / 2) + "px)");
                            scaleR = Math.min(screenHeight, screenWidth / stageR) / dreamWidth
                        }
                        //旋转
                        main_transforms.push("rotate(-90deg)");
                    }
                }

                // desktop
                if (screenR < 1 && screenWidth > 800) {
                    window.isDesktop = true;
                    if (window.needRotate){
                        dreamWidth = screenHeight / stageR;
                        main_transforms.length = 0;
                        scaleR = 1;
                    }
                }

                //根据DreamWidth设置rem
                if (setREM) {
  
                    var fontEl = document.createElement('style');
                    document.documentElement.firstElementChild.appendChild(fontEl);
                    window.REM = dreamWidth * FONTRatio;
                    fontEl.innerHTML = 'html{font-size:' + window.REM * offsetRatio + 'px!important;}';
                }

            
                return main_transforms;
            }
            var mainTrans = calculate(true);

            window.initialPageCorrect = !window.needRotate;

            window.templatePartials = [];

        </script>




</head>
<body>
    
    <div id='main'>
    <div id='loading'>
        <img id="logo" width="80" style="top:calc(40% - 1em)">
        <div id='banner' style='display:none;'>ppj.io  一键把PPT发布为H5</div>
        <svg id='logo' style='display:none;' version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
            width="60.699px" height="50px" 
            viewBox="367.052 205.153 300.699 133.33" xml:space="preserve">
            <symbol  id="p" viewBox="-48.947 -65.482 97.895 130.964">
            <path d="M-44.446-60.982c0,0.119,0,77.756,0.001,77.875c0.192,24.383,20.017,44.089,44.446,44.089c24.547,0,44.447-19.898,44.447-44.447c0-24.548-19.899-44.446-44.447-44.446S-44.447-8.014-44.447,16.535"/>
            </symbol>
            <g fill="none" stroke="white" stroke-width="9" stroke-linecap="round">
            <use xlink:href="#p"  width="97.895" height="130.964" x="-48.947" y="-65.482" transform="matrix(1 0 0 -1 415.9993 273)" overflow="visible"/>
            <use xlink:href="#p"  width="97.895" height="130.964" x="-48.947" y="-65.482" transform="matrix(1 0 0 -1 513.9993 273)" overflow="visible"/>
            <path d="M562.875,271.659
            c0-45.445,54-80.659,100.375-51.159"/>
            <path d="M663.25,323.954c-47.5,27.546-100.375-6.357-100.375-52.295"/>
            <path d="M597.5,303v-58.5c0,0,0-22,51-9.25 M598,266.5h63M637.5,268v52"/>
            <g stroke-width="4">
            <path d="M600,279.75c0-6.188,2.625-10.73,9.688-10.73"/>
            <path d="M640,279.75c0-6.188,2.625-10.73,9.688-10.73"/>
            <path d="M600,249.392c-0.396,7.554,0.312,14.17,12.562,14.67"/>
            </g>
            <path d="M455.4,235.875c4.476,8.375,9.601,31.958,25.726,50.5"/>
            </g>
            <g fill="none" stroke="black" stroke-width="6">
            <path d="M482.125,275c-10.25-14.5-15.398-31.581-19-41"/>
            <path stroke-linecap="square" d="M558.447,284.12c6.679-15.147,17.083-34.728,17.929-36.245"/>
            </g>
        </svg>
        <div id='loading-bar'>
            <div id='loading-progress'></div>
        </div>
        <div id='protect-hint'>
            <div class='protect-content'>
                <div class="password-area">
                    <h3 lazy="继续观看需要密码">页面受密码保护</h3>
                    <div class='password-container'>
                        <input id='protect-password' type='password' placeholder="请输入访问密码"><span id='submit-password' class="load-btn" href="">确定</span>
                    </div>
                </div>
                <div class="purchase-area">
                    <h3 lazy="继续观看需付费">内容需要付费观看</h3>
                    <div id='base-area'>
                        <span id='purchase-btn' class="load-btn" href="">打赏 <span id="purchase-price">5</span> 元</span>
                    </div>
                    <div id='qrpay-area'>
                        <h5>微信扫一扫完成支付</h5>
                        <img id='qrpay-qrcode' width="192" height="192" >
                    </div>
                </div>
                <div id='hint-container' class='hint-container'>
                    <pre id='hint-content'>长按扫描二维码
回复"PPT"获取访问密码</pre>
                    <img id='wechat-qrcode' width="192" height="192" style='display:none' >
                </div>
            </div>
        </div>

        <div id="loading-entry" class="hide">点击屏幕继续加载</div>
    </div>
    <div class="reveal slides-container hide" id='pages'>
        <div id='slides' class="slides slides-wrapper">
            
        <!-- htmltobuild:template templates/template.html -->
        <script>
        window.templatePartials = ["templates/template.html"]
        </script>
        <!-- endtobuild -->

        <!-- htmltobuild:template preview.html -->
        <script>
        window.templatePartials = ["preview.html"]
        </script>
        <!-- endtobuild -->
        
            </div>
            
    </div>

    <audio id='bgm' autoPlay loop></audio>
    <div id='toast' style='display:none'><span class='message'></span></div>
    </div>
    <div id='arrow' class='hide'><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAAkCAMAAADip6m2AAAAolBMVEUAAAAAAAAAAAAAAAAAAAABAQEAAAAAAAAHBwcAAAD////9/f37+/vt7e25ubn39/cKCgrz8/Pe3t7c3Nz+/v729vbW1tZra2tKSkoAAABpaWlgYGD9/f38/Pz5+fn5+fn39/fz8/Px8fHu7u7q6urm5ubj4+Pd3d3y8vLX19fJycnAwMC4uLisrKyhoaGVlZWGhoajo6MpKSkxMTGAgID///9oDYyzAAAANXRSTlMAAwcLFR0SGRAO+efJbSOcIqBDQvLNbTEpGxEQ9e3h29XDvLOsnJOJiIFpYVlNRkE7MiwfDLl52bwAAAGFSURBVEjH3ZXZboMwFERbHAMhC6EFQtrs+777/3+t98bGjmwqy32plHmLPYfMiYTy9nJ5F/kb693j+O4h7Y567SZjzbYHuDv72WCQxgfSjixpReyRqEWAdmK/YyaTfAHtpivjIo6TUReTZYxxcZzupju/XufP4g660aYD2USmuF13sKeP7Ae6uF13fKZBDRLQ81gTt+rOCmD9MPSBLmaauEV3hWidQOqIr57FLbrpDllCPAghSO9SU7xad3QCNiRQgwAeAn0a6eLVutOC4mRk+SCcToupIW7qsmWnByw25B3Svc6SaeKGbn9LA8UqGsW3fVMc2VJ3eJS6apcUPw5LcVmAq1J30qWBL1mN9gPanZTiUBE3pe5C6cpo4gtRjXkJjtf8cbnSlTHEcz5yTTwBh00UOVToVogfGvibhQq+pCyr0q0Wz1h6kTDsyZObPvn36bckh6qA8YE1eIUEa6GxyyeKEzhC1MLy6byL3yNP4BNn7TSWVRffHYHaI7qq7PB3qMr/mh8s20b2bOZlXQAAAABJRU5ErkJggg==" width="30"></div>

<script>
    switch (true){
        case doc_info.logo === null:
        case parseInt(doc_info.logo) == 0:
            var logo = document.getElementById("loading");
            logo.className = logo.className + " default-logo"
            break;

        case doc_info.logo.length > 2:
            document.getElementById("logo").src = doc_info.logo;
            break;
            
    }
</script>
 <script>

    // mock
    //window.doc_info = { auth_type: 2, price: 10 /*wechat_spell: "test", wechat: "ydbj2015"*/ }
    //block wx black background
    document.body.addEventListener("touchmove", function (e) {
        e.preventDefault();
    }, false);

    document.body.className += " " + ["hide-bgm-btn", "hide-page-number"].filter(function(k){
        return doc_info[k.split("-").join("_")];
    }).join(" ")

    if (window.doc_info.price) {
        var price = parseFloat((parseFloat(window.doc_info.price) || 0).toString().replace(/\.?0*$/, ''));
        if (price){
            window.doc_info.auth_type = 3;   
            document.getElementById("purchase-price").innerHTML = window.doc_info.price;
        }
    }
    window.isProtected = window.doc_info.auth_type > 0
    

    window.isLazyProtected = window.doc_info.previewCount;

    if (window.isLazyProtected) {
        window.isProtected = false;
    }
    if (window.doc_info.templates_name){
        window.isProtected = false;
        window.isLazyProtected = false;
    }
    
    var hint, wechat_spell, wechat_id;
    if ( window.doc_info.auth_type == 1 && window.doc_info.auth_hint){
        hint =  "提示：" +  window.doc_info.auth_hint;
    }
    if (window.doc_info.auth_type == 2){
        hint = "长按扫描二维码\n回复\"" + window.doc_info.wechat_spell + "\"获取访问密码";
        wechat_spell = window.doc_info.wechat_spell;
        wechat_id = window.doc_info.wechat
        document.getElementById("loading").className += " extra-large"
    }
    if (window.doc_info.auth_type == 3){
        document.getElementById("protect-hint").className += " need-pay"
    }

    if (hint){
        document.getElementById("hint-container").style.display = "block";
        document.getElementById("hint-content").innerHTML = hint;
    }
    if (wechat_spell){
        var img = document.getElementById("wechat-qrcode");
        var qrcode = "//open.weixin.qq.com/qr/code/?username=" + wechat_id;
        if (/^http/.test(wechat_id)) {
            qrcode = wechat_id; 
        }
        img.src = qrcode
        img.style.display = "inline-block";
    }
    var main = document.getElementById("main");
    if (window.isProtected){
        main.className += " protected";
    }
    var resize = function(){
        var main = document.getElementById("main")
        main.className = main.className.replace(/\s*protected\s*/g, '') + " sized";
        if (mainTrans.length > 0) {
            main.style.webkitTransform = main.style.transform = mainTrans.join(" ");
        } 
        if (window.isDesktop) {
            main.style.webkitTransform = main.style.transform="none"
            main.style.margin = "0 auto"
        }
    }
    
    if (!window.templatePartials.length){
        resize();
    } else {
        switch (true){
            case parseInt(doc_info.previewCount) > 0:
                window.templatePartials = ["preview.html"];
                break;
            case !!doc_info.templates_name:
                window.templatePartials = [doc_info.templates_name];
                window.doc_info.templates_name = "templates"
                break;
            default:
                window.templatePartials = ["templates/template.html"];
                break;
        }
    }

    if (stretch == "fullscreen" && !"ActiveXObject" in window) {
        var panel = document.getElementById("user-panel");
        if (panel) {
            panel.className += ' fullscreen';
            panel.style.webkitTransform = 'scale(' + scaleR + ') translate3d(0,0,0)'
        }
    }
    window.addEventListener("orientationchange", function () {
        //location.reload();
        var t = screenWidth;
        screenWidth = screenHeight;
        screenHeight = t;
        main.style.webkitTransform = main.style.transform = calculate().join(" ");

        setTimeout(function () {
            screenWidth = document.documentElement.clientWidth;
            screenHeight = document.documentElement.clientHeight;
            main.style.webkitTransform = main.style.transform = calculate(true).join(" ");

            var page = Number(window.Reveal && Reveal.getCurrentSlide() && Reveal.getCurrentSlide().id.replace("slide-", "")) || 0;
            if (!window.isProtected && page==0 && ((screenHeight / screenWidth - 1) * (stageHeight / stageWidth - 1) > 0) && !initialPageCorrect){
                window.location.reload();
                return;
            }

            Reveal.configure({rotate: !Reveal.getConfig().rotate});
            window.frame && window.frame.refreshSlide();

        }, 1000);
    })
</script>

    <script src="//res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>

    <script src="./common/js/loader_7b90db.js"></script>
    <script>
                function templateLoad(dom){
                    if ($(dom).children("div.reveal-template").length <= 0){
                        var script = $(dom).find("script[type='template']");
                        if (!script.attr("url")){
                            $(dom).append($("<div class=\"reveal-template\"></div>").html(script.html()));
                        }
                        else {
                            $.get(script.attr("url"), function(rs){
                                $(dom).append($("<div class=\"reveal-template\"></div>").html(rs));
                            }, 'html');
                        }
                    }
                }

                function templateUnload(dom){
                    $(dom).children("div.reveal-template").trigger('destroy').remove();
                }
                function initSlide(i) {
                    //window.slides[i].init()
                    $(document.body).trigger("initSlide", [i])
                }

                function playSlide(i) {
                    function doPlay(){
                        var ret = window.slides[i].restart()
                        window.currentSlide = window.slides[i]
                        $(document.body).trigger("playSlide", [i])
                        return ret;
                    }
                    var initPromise = $(document.body).triggerHandler("beforePlay");
                    if (initPromise && initPromise.done){
                        return initPromise.done(function(){
                            return doPlay()
                        })
                    } else {
                        return doPlay()
                    }
                }

                function stopSlide(i) {
                    window.slides[i].stop()
                }
            function moveToSlide(id, prev){
                var slide = $("#slide-" + id);
                templateLoad(slide)
                prev = prev === undefined ? -1 : prev;
                $.when(playSlide(id)).done(function(){
                    $('.reveal-slide > .reveal-template').not(slide.find('.reveal-template')[0]).trigger('destroy').remove()
                    if (id > prev){
                        templateLoad($("#slide-" + (id + 1)));
                    } else {
                        templateLoad($("#slide-" + (id - 1)));
                    }
                })
            }
            function rememberPage(i){
                LocalDB.set(CACHE_PAGE, i, { expires: new Date(new Date().getTime()+ 1000 * 60 * 5) })
            }
            function getIndex(){
                return Reveal.getIndices().h
            }
            function enableSwipeOnDesktop(){
                var originPosition = {};
                var offsetX, offsetY;

                var mousemove = function(offsetX, offsetY){
                    if (frame.touch == false || !frame.canClickAdvance()) return;
                    var THRESHOLD = 50;
                    var offset = 0;
                    var direction;

                    if (Math.abs(offsetX) > Math.abs(offsetY)){
                        if (window.transitionDirection == "vertical") return;
                        offset = Math.abs(offsetX);
                        direction = offset / offsetX;
                    } else {
                        if (window.transitionDirection == "horizontal") return;
                        offset = Math.abs(offsetY);
                        direction = offset / offsetY;
                    }
                    
                    if (offset < THRESHOLD) return;

                    if (direction == 1){
                        window.frame.prevSlide();
                    } else {
                        window.frame.nextSlide();
                    }

                }

                document.body.addEventListener('mousedown', function(event){
                    originPosition.x = event.clientX;
                    originPosition.y = event.clientY;
                }, false);

                document.body.addEventListener('mouseup', function(event){
                    offsetX = event.clientX - originPosition.x;
                    offsetY = event.clientY - originPosition.y;

                    mousemove(offsetX, offsetY);
                }, false);
                document.body.addEventListener('dragstart',function(e){
                    e.preventDefault();
                    e.stopPropagation();
                });

            }
            function initFrame(){
                window.frame = {
                    autoPlay: autoPlay,
                    touch: true,
                    paused: false,
                    open: function(){
                        if (!window.isDesktop){
                            if (window.history && window.history.replaceState) {
                                window.history.replaceState('record', document.title, "?back_remember=" + getIndex());
                            } else {
                                rememberPage(getIndex());
                            }
                        }
                        return window.open.apply(window, arguments);
                    },
                    disableTouch: function(){
                        frame.touch = false;
                        Reveal.configure({touch: false});
                        $(document.body).on('slideComplete.dd', function(){
                            return false;
                        })
                    },
                    enableTouch: function(){
                        frame.touch = true;
                        Reveal.configure({touch: true});
                        $(document.body).off('slideComplete.dd');
                    },
                    enableClickAdvance: function () {
                        Reveal.configure({touch: true});
                    },
                    disableClickAdvance: function () {
                        Reveal.configure({touch: false});
                    },
                    canClickAdvance: function(){
                        return Reveal.getConfig().touch
                    },
                    jumpSlide: function (i, time) {
                        if (i < 0) return false;
                        if (i >= window.slides.length){
                            $(document.body).trigger("finale");
                            return false
                        }
                        if (window.slides[i].transition && (window.slides[i].transition.effect == undefined || window.slides[i].transition.effect == "none" || time === 0)){
                            $(Reveal.getCurrentSlide()).attr('data-transition', 'none-out');
                            $('#slide-' + i).attr('data-transition', 'none');
                            window.slides[i].waitTransition = false
                        } else {
                            $(Reveal.getCurrentSlide()).removeAttr('data-transition')
                            $("#slide-" + i).removeAttr('data-transition')
                            if (window.slides[i].transition.duration) {
                                $(Reveal.getCurrentSlide()).css({"-webkit-transition-duration" : window.slides[i].transition.duration + "s" });
                                $("#slide-" + i).css({"-webkit-transition-duration" : window.slides[i].transition.duration + "s" });
                            }
                            window.slides[i].waitTransition = true
                        }
                        //mediaController.stopAll()
                        Reveal.slide(i, 0);

                        if (i >= Reveal.getTotalSlides()){
                            var event = document.createEvent( 'HTMLEvents', 1, 2 );
                            event.initEvent("hitend", true, true );
                            $("#pages")[0].dispatchEvent(event);
                            return false
                        }
                        return true
                    },
                    nextSlide: function(j){
                        var i =  getIndex();
                        if (j !== undefined && i !== j) return;
                        return window.frame.jumpSlide(i + 1);
                    },
                    prevSlide: function(){
                        var i =  getIndex();
                        return window.frame.jumpSlide(i - 1);
                    },
                    refreshSlide: function(s){
                        // TODO tingtang
                        var slide = s || Reveal.getCurrentSlide();
                        var id = Number(slide.id.replace("slide-", ""));
                        $(document.body).trigger('refreshSlide', [id])
                        if (window.slides[id].completed) return;
                        templateUnload(slide);
                        templateLoad(slide);
                        playSlide(id);             
                    },
                    getIndex: function(){
                        return getIndex();          
                    },
                    getTotalSlides: function(){
                        return Reveal.getTotalSlides();
                    },
                    getCurrentSlide: function(){
                        return window.currentSlide; 
                    },
                    getCurrentTimeline: function(){
                        return window.currentSlide.window.main;                    
                    },
                    backward: function(){
                        return frame.getCurrentSlide().backward() || (frame.prevSlide() && frame.getCurrentSlide().backward('end'));
                    },
                    forward: function(){
                        return frame.getCurrentSlide().forward() || frame.nextSlide();
                    },
                    backward2: function(){
                        switch(frame.getCurrentSlide().backward2()){
                            case true: return true;
                            case false: return frame.prevSlide() && frame.getCurrentSlide().backward2('end');
                            case undefined: return false;
                        }
                    },
                    forward2: function(){
                        switch(frame.getCurrentSlide().forward2()){
                            case true: return true;
                            case false: return frame.nextSlide();
                            case undefined: return false;
                        }
                    },
                    snapshot: function(){
                        var ret = {}
                        ret[frame.getIndex()] = frame.getCurrentSlide().progress();
                        return JSON.stringify(ret);
                    },
                    restore: function(s){
                        var ss = JSON.parse(s), i = parseInt(Object.keys(ss)[0]), progress = ss[i];
                        if (i == frame.getIndex()){
                            frame.getCurrentSlide().goto(progress);
                            return;
                        }
                        frame.jumpSlide(i)
                        $(document.body).on("playTimeline.travel." + i, function(event, j){
                            $(document.body).off("playTimeline.travel." + j)
                            if (i!== j) {
                                console.error('travel error');
                                return;
                            }

                            var slide = window.slides[i];
                            $(document.body).one("timelineStart.travel", function(event, j){
                                slide.goto(progress);            
                            })
                        }) 
                    },
                    mockAction:function(action, index, id, stopped){
                        var oe = $.Event(action);
                        oe.stopped = stopped
                        var event = $.Event(action, { originalEvent: oe , mock : true })           
                        $("#slide-" + index + " #" + id).trigger(event);
                    },
                    trackAction: function(callback){
                        $(document.body).on("track", function(event){
                            callback && callback(event, event.action, event.slideIndex, event.targetId, event.stopped);        
                        })             
                    },
                    pause:function(){
                        frame.paused = true;
                        return frame.getCurrentSlide().pause();
                    },
                    resume: function(){
                        frame.paused = false;
                        return frame.getCurrentSlide().resume();
                    }

                }
            }
            function initPage(){
                var config = {"mode":"ppt"};

                var effectMap = {
                    "none": "slide",
                    "slide": "slide",
                    "cube": "slide",
                    "slide-3d": "slide",
                    "fade": "fade"
                }
                if (window.doc_info.templates_name && window.doc_info.templates_name != "templates"){
                    utils.preloadProtect(undefined, { templates_name: window.doc_info.templates_name });
                }

                var transitionDirection = (config.direction == "h5" || stageWidth < stageHeight) ? "vertical" : "horizontal";
                var effect = "slide";
                if (config.transition) {
                    transitionDirection = config.transition.direction || transitionDirection;
                    effect = effectMap[config.transition.effect] || effect;
                }
                window.transitionDirection = transitionDirection;

                if (window.transitionDirection == "vertical") {
                    $("#slides").addClass("vertical");
                }

                if (window.isDesktop){
                    enableSwipeOnDesktop();
                }
         
                Reveal.addEventListener('ready', function (event) {
                    window.slides.map(function (s, k) {
                        initSlide(k);
                    })
                    var id = parseInt((location.href.match(/\bback_remember=(\d+)/) || [])[1]) || parseInt(LocalDB.get(CACHE_PAGE)) || parseInt((location.href.match(/\bpage=(\d+)/) || [])[1]);
                    if (id){
                        window.frame.jumpSlide(id, 0);
                    } else {
                        window.slides[0].waitTransition = false;
                        moveToSlide(0);
                    }
                    var event = document.createEvent( 'HTMLEvents', 1, 2 );
                    event.initEvent("complete", true, true );
                    document.body.dispatchEvent(event);
                })
                Reveal.addEventListener("hitend", function(event){
                    if (window.isLazyProtected && Reveal.getTotalSlides() < window.slides.length && !window.protectShowed){
                        utils.showProtect();
                        rememberPage(getIndex());
                        window.protectShowed = true;
                        return;
                    }        
                        
                    $(document.body).trigger("finale");
                })
                Reveal.addEventListener('slidechanged', function (event) {
                    mediaController.stopAll();
         
                    var id = Number(event.currentSlide.id.replace("slide-", ""));
                    var prev = Number(event.previousSlide.id.replace("slide-", ""));
                    stopSlide(prev);
                    moveToSlide(id, prev);

                    var event = new CustomEvent('slideChange', { detail : { 'index': id, prev: prev, total: window.slides.length }});
                    document.body.dispatchEvent(event);
                })

                Reveal.initialize({
                    controls: false,
                    progress: false, //window.isDesktop,
                    overview: false,
                    center: false,
                    width: '100%',
                    height: '100%',
                    margin: 0,
                    transition: effect,
                    rotate: !window.isDesktop && window.needRotate,
                    vertical: window.transitionDirection == "vertical",
                })


            }
               
    </script>

    <script>
    var audioSprites = {"urls":["./images/output_750144.mp3"],"sprite":{"silence":[0,4000,true],"media1_90136":[5000,19410.045351473924],"media2_425428":[26000,83253.31065759638],"media3_21705":[111000,4598.616780045348],"media4_17547":[117000,3396.9841269841227],"media5_20951":[122000,4494.126984126979],"media6_12135":[128000,2561.065759637188],"media7_9847":[132000,2064.7392290249513],"media8_86966":[136000,17059.024943310647]},"sources":["./images/media1_90136.mp3","./images/media2_425428.mp3","./images/media3_21705.mp3","./images/media4_17547.mp3","./images/media5_20951.mp3","./images/media6_12135.mp3","./images/media7_9847.mp3","./images/media8_86966.mp3"],"test":"./common/silence.mp3"}
    var INFO = {"invokeMedia":12}
    var fonts = ["宋体","宋体","Calibri","Calibri","Cooper Black","Century Gothic"]

    var commonDir = function(i){ return commonCDN +  i }
    </script>

    <script>

    var C = function(src){
        var args = [CDN];
        if (!/^\//.test(src) && CDN.length > 1){
                args.push(UID);
        }
        args.push(src.replace(/^\.?\/?/, ""));
        return args.join("/");
    }
    var V = function(src){
        var v = new Date().getTime();
        return C(src) + "?v=" + v;
    }
    var pluginScripts = {
        tt : {
            plugin : ["/common/js/tt_2.js?=" + new Date().getTime()],
            page : [backend + "/modify_show.js?callback=tt_init&uid=" + UID + (doc_info.scid ? ("&scid=" + doc_info.scid) : "")],
            css : [ CDN + "/common/css/tt_2.css?=" + new Date().getTime() ]
        },
        tt_client : {
            plugin: ["/common/js/tt_client_2.js?=" + new Date().getTime()],
            page : [backend + "/show.js?callback=tt_init&uid=" + UID],
            css : [ CDN + "/common/css/tt_2.css?=" + new Date().getTime() ]
        },
        "" : {
            plugin : [],
            page : [],
            css : []
        }
    }
    var CACHE_PAGE = [UID, "last_page", "v1", window.doc_info.doc_version || "0"].join("_");
    window.LocalDB = {
        set: function(key, value, attributes){
            document.cookie = [
					key, '=', value,
					attributes.expires ? '; expires=' + attributes.expires.toUTCString() : '', // use expires attribute, max-age is not supported by IE
					attributes.path ? '; path=' + attributes.path : '',
					attributes.domain ? '; domain=' + attributes.domain : '',
					attributes.secure ? '; secure' : ''
			].join('')
        },
        get: function(k){
            return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*" + encodeURIComponent(k).replace(/[\-\.\+\*]/g,     "\\$&") + "\\s*\\=\\s*([^;]*).*$)|^.*$"), "$1")) || null;
        }
    }
    window.waitAudioContext = function(callback) {
        var completed = false;
        var try_hack = function() {
            if (window.wx && Pui.browser.wechat) {
                wx.checkJsApi({
                    complete: function(res) {
                        if (!completed) {
                            completed = true;
                            callback && callback();
                        }
                    }
                })
            } else {
                completed = true;
                callback && callback();
            }
            setTimeout(function() {
                if (!completed) {
                    try_hack();
                }
            }, 300)
        }
        try_hack();
    }
    window.loadAssets || (window.loadAssets = {
        debug: /debug/.test(window.location.href),
        css : [V("css/page.css")].concat(pluginScripts[window.pluginMode || ""].css),
        js : {
            lib:  ["/common/js/jquery_c6510f.js","/common/js/lib_dc6343.js"].map(commonDir),
            plugin : ["/common/js/plugin_668cb5.js"].concat(pluginScripts[window.pluginMode || ""].plugin).map(commonDir),
            page: [V("js/page.js")].concat(pluginScripts[window.pluginMode || ""].page)
        },
        audio: audioSprites,
        html: window.templatePartials.map(function(i){ return V(i) + "#slides" }),
        font: fonts,
        production: true,
    })

    </script>

    <script>
          
            window.wxConfig = window.wxConfig || {};
            window.wxConfig.shareObj = {
                title: doc_info.title, //"Demo-Animals-20180423",
                link: shareLink,
                imgUrl: doc_info.cover && (doc_info.cover + "!wxshare"), // "!wxshare",
                desc:  doc_info.description, //"Demo-Animals-20180423",
                success: function (event) {
                    // 用户分享成功后的回调函数
                    console.log(event);
                    $("body").append("<script async src='" + BACKEND + "/api/tracks/share?type=" + /(\w+):ok/.exec(event.errMsg)[1] + "&now=" + new Date().getTime() + "'><\/script>")
                },
                fail: function(error) {
                    console.error(error);
                }
            };
           var hasMultipleAudio = window.audioSprites && window.audioSprites.sources && window.audioSprites.sources.length > 2;
           var invokeMedia = hasMultipleAudio && (INFO.invokeMedia >= 3) && (INFO.invokeMedia * 2 >= window.audioSprites.sources.length);
           var usingWebAudio = hasMultipleAudio && !invokeMedia;
           var options = {
                css: loadAssets.css,
                js: loadAssets.js,
                audio: loadAssets.audio,
                html : loadAssets.html,
                font: loadAssets.font,
                debugger: !loadAssets.production,
                commonArgs: !loadAssets.production && !window.isDesktop && ("v=" + new Date().getTime()),
                wxRequired:  wxRequired || (/android/i.test(navigator.userAgent) && window.audioSprites && window.audioSprites.urls && window.audioSprites.urls.length > 0),
                wxConfig: window.wxConfig,
                usingWebAudio: usingWebAudio,
                onpause: function(template, callback){
                    if (!window.isProtected){
                        resize();
                        callback(template);
                        return;
                    }
                    $script.ready(['complete'], function(){
                        utils.initProtect(template, { block : true }, function(url){
                            resize();
                            callback(url)
                        });
                    })
    
                },

                onprogress: function () {
                    var self = this;
                    var p = self.count() / self.total();
                    var scale = "scaleX(" + p + ")"
                    var bar = document.getElementById("loading-progress");
                    bar.style.transform = scale;
                    bar.style.webkitTransform = scale;
                },
                oncomplete: function () {
                    function complete() {
                        setTimeout(function(){
                            ("ontouchstart" in window) && FastClick.attach(document.body);
                            $("#pages").removeClass('hide')
                            $("#loading").addClass("fade").bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd", function () {
                                $("#loading").hide();
                            });
                            initFrame();
                            initPage();

                        })
                    }
                    var self = this;
                    var options = self.audio();
                    console.log("Finish loading assets. basic info below:");
                    options.supportWebAudio = Pui.browser.supportWebAudio && !Pui.browser.android && usingWebAudio ;
                    console.log("using web audio: ", options.supportWebAudio);

                    options.load_required = false;
                    options.onload = complete;

                    if (options.urls && options.urls.length > 0){
                        if (!Pui.browser.wechat && (Pui.browser.android || Pui.browser.ios)) {
                            console.log("Require User interaction!");
                            // $("#loading-entry").click = function(){     options.onload(); }
                            $("#loading").one("click", function () {
                                console.log("hit entry");
                                window.mediaController = new MediaController(options);
                            });

                            $("#loading-bar").hide();
                            $("#loading-entry").removeClass("hide");
                        } else {
                            window.waitAudioContext(function(){
                                window.mediaController = new MediaController(options);
                            })
                        }
                    } else {
                        delete options.onload;
                        window.mediaController = new MediaController(options);
                        complete();
                    }

                    (function(){
                        var playAudio = function(src){
                            var a = $("#bgm")[0]
                            a.src = src;
                            a.loop = true;
                            //$(document.body).append(a);
                            a.play();
                            if (doc_info.external_bgm_volume){
                               a.volume = doc_info.external_bgm_volume; 
                            }
                        }
                        var toggleAudio  = function(){
                                var a = $("#bgm")[0]
                                if (a.paused) {
                                    a.play();
                                    return true;
                                } else {
                                    a.pause()
                                    return false;
                                }
                        }
                        var K = "WA_BGM_" + UID
                        var playWebAudio = function(src){
                            LocalDB.set(K, 1, { expires: new Date(new Date().getTime()+ 1000 * 60 * 1) })
                            console.log("using webaudio for bgm")
                            var AudioContext = window.AudioContext || window.webkitAudioContext;
                            var audioCtx = new AudioContext();
                            var source = audioCtx.createBufferSource();
                            var gainNode = audioCtx.createGain();
                            gainNode.connect(audioCtx.destination);
                            gainNode.gain.value = doc_info.external_bgm_volume || 1;
                            var xhr = new XMLHttpRequest();
                            xhr.open('GET', src, true);
                            xhr.responseType = 'arraybuffer';
                            xhr.onload = function() {
                                audioCtx.decodeAudioData(
                                    xhr.response,
                                    function(buffer) {
                                        source.buffer = buffer;   
                                        source.loop = true
                                        source.connect(gainNode);
                                        source.start()
                                        LocalDB.set(K, 0, { expires: new Date(new Date().getTime()+ 1000) })
                                    },
                                    function(err) {
                                        playAudio(src);
                                    }
                                );

                            };
                            xhr.send()
                            toggleAudio = function() {
                                if(audioCtx.state === 'running') {
                                    audioCtx.suspend()
                                    return false;
                                } else if(audioCtx.state === 'suspended') {
                                    audioCtx.resume()  
                                    return true;
                                }
                            }      
                        }
                        var play = function(src){
                          if (!LocalDB.get(K) && doc_info.external_bgm_volume < 1 && Pui.browser.ios && Pui.browser.supportWebAudio) {
                            playWebAudio(src);
                          } else {
                            playAudio(src)
                          }
                        }
                        if (window.doc_info.external_bgm){
                            if (!doc_info.hide_bgm_btn) {
                                $(".bgm-btn").removeClass("hide");
                            }
                            waitAudioContext(function(){
                                play(window.doc_info.external_bgm)
                                $(".bgm-btn").addClass("rotate");
                            })
                            $(document.body).on("click", ".bgm-btn", function(){
                                $(this).toggleClass("rotate", toggleAudio())
                            })
                        }
                    }())
                }
            }

            if (loadAssets.debug) {
                var vconsole = document.createElement("script");
                vconsole.onload = function () {
                    var vConsole = new VConsole();
                    console.log('start to load assets.');
                    window.loader = new $loader(options);
                };
                vconsole.src = "./common/vconsole.min.js?" + (new Date().getTime());
                document.head.appendChild(vconsole);
            } else {
                window.loader = new $loader(options);
            }

       
    </script>

      
</body>
</html>
